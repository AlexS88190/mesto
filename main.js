(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=t((function e(t,o,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"_getTemplate",(function(){return document.querySelector(i._cardSelector).content.querySelector(".elements__item").cloneNode(!0)})),n(this,"generateCard",(function(){return i._initElements(),i._addEventListener(),i._linkCard.src=i._link,i._linkCard.alt=i._title,i._nameCard.textContent=i._title,i._cardElement})),n(this,"_removeCard",(function(e){i._cardElement.remove(),i._destroyElements()})),n(this,"_destroyElements",(function(){i._trashButton=null,i._cardElement=null,i._likeButton=null,i._nameCard=null,i._linkCard=null})),n(this,"_initElements",(function(){i._cardElement=i._getTemplate(),i._linkCard=i._cardElement.querySelector(".elements__image"),i._nameCard=i._cardElement.querySelector(".elements__title"),i._trashButton=i._cardElement.querySelector(".elements__trash"),i._likeButton=i._cardElement.querySelector(".elements__like-button")})),n(this,"_likeCard",(function(e){i._likeButton.classList.toggle("elements__like-button_active")})),n(this,"_handleOpenZoomPopup",(function(e){i._openZoomPopup(i._title,i._link)})),n(this,"_addEventListener",(function(){i._trashButton.addEventListener("click",i._removeCard),i._likeButton.addEventListener("click",i._likeCard),i._linkCard.addEventListener("click",i._handleOpenZoomPopup)})),this._title=t.name,this._link=t.link,this._cardSelector=o,this._openZoomPopup=r}));function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"enableValidation",(function(){o._formElement.addEventListener("submit",(function(e){e.preventDefault()})),o._setEventListeners()})),i(this,"_setEventListeners",(function(){o._inputList.forEach((function(e){e.addEventListener("input",(function(){o._updateInputErrors(e),o.toggleButtonState()}))}))})),i(this,"_updateInputErrors",(function(e){o._isInputValid(e)?o._hideInputError(e):o._showInputError(e,e.validationMessage)})),i(this,"_hideInputError",(function(e){var t=o._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(o._selectors.inputErrorClass),t.classList.remove(o._selectors.errorClass),t.textContent=""})),i(this,"_showInputError",(function(e,t){var n=o._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(o._selectors.inputErrorClass),n.textContent=t,n.classList.add(o._selectors.errorClass)})),i(this,"toggleButtonState",(function(){o._formElement.checkValidity()?(o._buttonElement.classList.remove(o._selectors.inactiveButtonClass),o._buttonElement.removeAttribute("disabled")):(o._buttonElement.classList.add(o._selectors.inactiveButtonClass),o._buttonElement.setAttribute("disabled","disabled"))})),i(this,"_isInputValid",(function(e){return e.validity.valid})),this._selectors=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._selectors.inputSelector)),this._buttonElement=this._formElement.querySelector(this._selectors.submitButtonSelector)}var t,n;return t=e,(n=[{key:"resetValidation",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t)}))}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=function(){function e(t,n){var o=t.items,r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=o,this._renderer=r,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){var n=e._renderer(t);e.addItem(n)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=s((function e(t){var n=this,o=t.profileTitleSelector,r=t.profileSubTitleSelector,i=t.profileAvatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"getUserInfo",(function(){return{profileTitle:n._profileTitleElement.textContent,profileSubTitle:n._profileSubTitleElement.textContent}})),p(this,"setUserInfo",(function(e){var t=e.profileTitle,o=e.profileSubTitle;n._profileTitleElement.textContent=t,n._profileSubTitleElement.textContent=o})),p(this,"setAvatar",(function(e){n._avatarElement.style.backgroundImage="url(".concat(e,")")})),this._profileTitleElement=document.querySelector(o),this._profileSubTitleElement=document.querySelector(r),this._avatarElement=document.querySelector(i)}));function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this),this._handleClosePopup=this._handleClosePopup.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){this._popup.addEventListener("click",this._handleClosePopup)}},{key:"_handleClosePopup",value:function(e){(e.target.classList.contains("popup__close-button")||e.target.classList.contains("popup"))&&this.close()}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=b(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},h.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function E(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(a,e);var t,n,o,r,i=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(o);if(r){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._popupZoomImage=t._popup.querySelector(".popup__image"),t._popupZoomTitle=t._popup.querySelector(".popup__zoom-title"),t}return t=a,(n=[{key:"open",value:function(e,t){h(g(a.prototype),"open",this).call(this),this._popupZoomImage.src=t,this._popupZoomImage.alt=e,this._popupZoomTitle.textContent=e}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(d);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=O(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},C.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}function j(e,t){return j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},j(e,t)}function P(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(a,e);var t,n,o,r,i=(o=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(o);if(r){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._form=n._popup.querySelector(".popup__form"),n._submitCallback=t,n._handleSubmitCallback=n._handleSubmitCallback.bind(T(n)),n}return t=a,(n=[{key:"setEventListeners",value:function(){C(L(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._handleSubmitCallback)}},{key:"_handleSubmitCallback",value:function(e){e.preventDefault(),this._submitCallback(this._getInputValues())}},{key:"_getInputValues",value:function(){var e={};return this._popup.querySelectorAll(".popup__input").forEach((function(t){e[t.name]=t.value})),e}},{key:"close",value:function(){C(L(a.prototype),"close",this).call(this),this._form.reset()}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(d);function q(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function B(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=B((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"getProfileInfo",(function(){return fetch("https://nomoreparties.co/v1/cohort-41/users/me",{headers:{authorization:"c5ad47cd-94e1-4e0d-ba61-6865eeedf90c"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){return console.log(e)}))})),R(this,"updateProfileInfo",(function(e,t){return fetch("https://mesto.nomoreparties.co/v1/cohort-41/users/me",{method:"PATCH",headers:{authorization:"c5ad47cd-94e1-4e0d-ba61-6865eeedf90c","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){return console.log(e)}))})),R(this,"updateAvatar",(function(e){return fetch("https://mesto.nomoreparties.co/v1/cohort-41/users/me/avatar",{method:"PATCH",headers:{authorization:"c5ad47cd-94e1-4e0d-ba61-6865eeedf90c","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){return console.log(e)}))}))})),x=new u({items:[{name:"Palm Jumeirah, Dubai",link:"https://lilastourism.com/wp-content/uploads/2017/11/skydive-dubai1.jpg"},{name:"Waialua, Hawaii",link:"https://live.staticflickr.com/5131/5447473435_2567ba3776_b.jpg"},{name:"Interlaken, Switzerland",link:"https://cantina-caverna.ch/wp-content/uploads/2017/08/visit_interlaken_lungern_view.jpg"},{name:"Majlis al Jinn, Oman",link:"https://www.getlostmagazine.com/wp-content/uploads/2016/05/GL35-OMAN-SS-JINN_CAVE-1500x900.jpg"},{name:"Stratosphere",link:"https://avatars.mds.yandex.net/get-zen_doc/1900011/pub_5dd9914ca4655250ff59d1c3_5debb1325d636200ad8366c6/scale_1200"},{name:"Chamonix, Switzerland",link:"https://www.orangesmile.com/common/img_cities_original/chamonix-mont-blanc--1418045-2.jpg"}],renderer:ie},".elements__list"),V=new f({profileTitleSelector:".profile__title",profileSubTitleSelector:".profile__subtitle",profileAvatarSelector:".profile__avatar"}),z=new w(".popup_type_zoom");z.setEventListeners();var Z=new I(".popup_type_place",(function(e){var t;t=ie({name:e.place,link:e.link}),x.addItem(t),Z.close()}));Z.setEventListeners();var D=new I(".popup_type_profile",(function(e){J.updateProfileInfo(e.name_profile,e.about_profile).then((function(){V.setUserInfo({profileTitle:e.name_profile,profileSubTitle:e.about_profile})})),D.close()}));D.setEventListeners();var N=new I(".popup_type_update",(function(e){J.updateAvatar(e.link).then((function(){V.setAvatar(e.link)})),N.close()}));N.setEventListeners();var J=new A,U=document.querySelector(".popup_type_profile"),H=document.querySelector(".popup_type_place"),M=document.querySelector(".popup_type_update"),G=U.querySelector(".popup__form_profile"),W=G.querySelector(".popup__input_type_name"),F=G.querySelector(".popup__input_type_about"),K=H.querySelector(".popup__form_place"),Q=M.querySelector(".popup__form_update"),X={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Y=document.querySelector(".profile__edit-button"),$=document.querySelector(".profile__add-button"),ee=document.querySelector(".profile__avatar-button");function te(e,t){z.open(e,t)}var ne=new a(X,G),oe=new a(X,K),re=new a(X,Q);function ie(e){return new o(e,".card-template",te).generateCard()}J.getProfileInfo().then((function(e){console.log(e),V.setUserInfo({profileTitle:e.name,profileSubTitle:e.about}),V.setAvatar(e.avatar)})),x.renderItems(),Y.addEventListener("click",(function(e){var t=V.getUserInfo();W.value=t.profileTitle,F.value=t.profileSubTitle,ne.resetValidation(),D.open()})),$.addEventListener("click",(function(e){oe.toggleButtonState(),Z.open()})),ee.addEventListener("click",(function(){console.log("openEditAvatar"),re.toggleButtonState(),N.open()})),ne.enableValidation(),oe.enableValidation(),re.enableValidation()})();